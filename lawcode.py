import streamlit as st
import pymongo
import bcrypt
import time
import datetime
import re
from pythainlp.tokenize import word_tokenize
from bson import ObjectId
from functools import lru_cache

from numpy import dot
from numpy.linalg import norm
from datetime import datetime
from uuid import uuid4

import pandas as pd
from transformers import AutoTokenizer, AutoModelForCausalLM, pipeline
import torch
from sentence_transformers import SentenceTransformer
import os
from dotenv import load_dotenv


load_dotenv()
HF_TOKEN = os.environ["HF_TOKEN"]


@st.cache_resource
def get_llm():
    tokenizer, model = get_tokenizer_and_model()
    device = 0 if torch.cuda.is_available() else -1
    # ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö CUDA memory
    if device == 0:
        try:
            torch.cuda.empty_cache()
        except:
            device = -1

    return pipeline(
        "text-generation",
        model=model,
        tokenizer=tokenizer,
    )


@st.cache_resource
def get_embedder():
    return SentenceTransformer("paraphrase-multilingual-MiniLM-L12-v2")


@st.cache_resource
def get_tokenizer_and_model():
    model_name = "models/llama3-3b"
    tokenizer = AutoTokenizer.from_pretrained(model_name, token=HF_TOKEN)
    model = AutoModelForCausalLM.from_pretrained(
        model_name,
        torch_dtype=torch.float16,
        device_map="auto",
        token=HF_TOKEN,
    )

    # ‚úÖ Fix pad token & attention_mask issue
    tokenizer.pad_token = tokenizer.eos_token
    model.config.pad_token_id = tokenizer.pad_token_id

    return tokenizer, model


# ‡πÉ‡∏ä‡πâ global ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£
tokenizer, model = get_tokenizer_and_model()

# MongoDB Atlas Connection
MONGO_URI = "Your Monmgo URL"
try:
    client = pymongo.MongoClient(MONGO_URI)
    db = client["law_database"]
    # Test connection
    client.admin.command("ping")
    document_collection = db["documents"]
    conversation_collection = db["conversations"]
except Exception as e:
    st.error(f"‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ: {str(e)}")
    st.stop()

# Create an empty placeholder for the alert message
alert_placeholder = st.empty()


# Function to hash passwords (if needed in the future)
def hash_password(password):
    return bcrypt.hashpw(password.encode("utf-8"), bcrypt.gensalt())


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Ñ‡∏•‡∏∂‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≠‡πÑ‡∏ã‡∏ô‡πå
def cosine_similarity(vec1, vec2):
    """Calculate the cosine similarity between two vectors."""
    return dot(vec1, vec2) / (norm(vec1) * norm(vec2))


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÉ‡∏´‡πâ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏±‡∏ö‡πÑ‡∏î‡πâ
def count_tokens(text):
    tokens = text.split()
    return len(tokens)


# Fetch chat history from MongoDB
def get_chat_history(username):
    try:
        chats = list(
            conversation_collection.find({"username": username}).sort("timestamp", -1)
        )
        return chats
    except Exception as e:
        st.error(f"Error fetching chat history: {str(e)}")
        return []


# Message----------------------------------------------------------------------------------------------------------------------------Message


# ‡πÄ‡∏û‡∏¥‡πà‡∏° CSS ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô sidebar ‡∏¢‡∏∑‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á
def add_css():
    st.markdown(
        """
        <style>
        .stButton > button {
            width: 100%;
        }
        </style>
    """,
        unsafe_allow_html=True,
    )


# Message


def display_ai_message_gradually(ai_response, message_placeholder):
    # If the response is not a DataFrame, display text gradually
    displayed_text = ""
    for char in ai_response:
        displayed_text += char
        message_placeholder.markdown(f"{displayed_text}")
        time.sleep(0.01)  # Adjust the speed here (0.01 = 10ms delay per character)


# Message


# Show chat history in sidebar
def show_chat_history_in_sidebar(username):
    if "chat_history" not in st.session_state:
        st.session_state["chat_history"] = get_chat_history(username)

    chat_history = st.session_state["chat_history"]
    st.sidebar.subheader(f"Chat History ({username})")

    for chat in chat_history:
        col1, col2 = st.sidebar.columns([8, 2])
        with col1:
            if col1.button(f"Q: {chat['question'][:30]}...", key=str(chat["_id"])):
                st.session_state["selected_chat"] = chat
        with col2:
            if col2.button("Delete", key=f"delete-{chat['_id']}"):
                delete_conversation(chat["_id"])


# Message_END----------------------------------------------------------------------------------------------------------------------------Message_END


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡∏ö‡∏ó‡∏™‡∏ô‡∏ó‡∏ô‡∏≤‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÉ‡∏ô‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô
def delete_conversation(conversation_id):
    conversation_collection.delete_one({"_id": ObjectId(conversation_id)})
    st.session_state["chat_history"] = [
        chat
        for chat in st.session_state["chat_history"]
        if str(chat["_id"]) != str(conversation_id)
    ]
    st.sidebar.success("Deleted conversation successfully!")


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• embedding ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡πâ‡∏≥‡∏ö‡πà‡∏≠‡∏¢ ‡πÜ
@lru_cache(maxsize=128)
def get_embedding_cache(question):
    embedder = get_embedder()
    return embedder.encode(question).tolist()


def clear_cache():
    if torch.cuda.is_available():
        torch.cuda.empty_cache()
    st.cache_resource.clear()


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô get_unique_id ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á ID ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ ObjectId ‡∏à‡∏≤‡∏Å MongoDB
def get_unique_id():
    return str(ObjectId())


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô clean_and_tokenize ‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡πÅ‡∏¢‡∏Å‡∏Ñ‡∏≥ (tokenize) ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö (content)
def clean_and_tokenize(content):
    # ‡∏•‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 ‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏û‡∏µ‡∏¢‡∏á 1 ‡∏ä‡πà‡∏≠‡∏á
    cleaned_content = re.sub(r"\s+", " ", content).strip()
    # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ '‡∏≥' ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÅ‡∏ó‡∏ô‡πÄ‡∏õ‡πá‡∏ô '‡∏≥‡∏≤'
    cleaned_content = cleaned_content.replace("‡∏≥‡∏≤", "‡∏≥")
    # tokenize ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
    tokens = word_tokenize(cleaned_content, keep_whitespace=False)
    # ‡∏•‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
    return "".join(tokens)  # ‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô delete_files_from_s3_and_mongodb ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å Amazon S3 ‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏à‡∏≤‡∏Å MongoDB
def delete_files_from_s3_and_mongodb(bucket_name, selected_file_names):
    for file_name in selected_file_names:
        for file in selected_file_names[file_name]:
            try:
                # # ‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å S3
                # s3_client.delete_object(Bucket=bucket_name, Key=file)
                # st.write(f"Deleted file from S3: {file}")
                # ‡∏•‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏à‡∏≤‡∏Å MongoDB ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå
                result = document_collection.delete_many({"pdf_name": file_name})
                if result.deleted_count > 0:
                    st.write(
                        f"Deleted {result.deleted_count} documents from MongoDB for file: {file_name}"
                    )
                else:
                    st.write(f"No documents found in MongoDB for file: {file_name}")
            except Exception as e:
                st.write(f"Error deleting file {file}: {str(e)}")


# ‡∏Å‡∏≤‡∏£‡∏ñ‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î--------------------------------------------------------------------------------------------------------------------------------------------‡∏Å‡∏≤‡∏£‡∏ñ‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Tokenization
def tokenize_text(text):
    if not text:
        raise ValueError("‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤")
    tokens = tokenizer.tokenize(text)
    if not tokens:
        raise ValueError("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô token ‡πÑ‡∏î‡πâ")
    return tokens


def classify_question_type(question):
    prompt = (
        "‡∏à‡∏á‡∏à‡∏≥‡πÅ‡∏ô‡∏Å‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÉ‡∏î "
        "(0=‡∏°‡∏≤‡∏ï‡∏£‡∏≤, 1=‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢, 2=‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á, 3=‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢):\n\n"
        f"‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: {question}\n\n"
        "‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:"
    )

    input_ids = tokenizer.encode(prompt, return_tensors="pt").to(model.device)

    # ‚úÖ ‡πÉ‡∏ä‡πâ max_new_tokens ‡πÅ‡∏ó‡∏ô max_length
    output = model.generate(
        input_ids,
        max_new_tokens=128,  # ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡πÄ‡∏ä‡πà‡∏ô 128 ‡∏´‡∏£‡∏∑‡∏≠ 256
        pad_token_id=tokenizer.eos_token_id,
    )

    predicted_class_text = tokenizer.decode(output[0], skip_special_tokens=True).strip()

    # ‚úÖ ‡∏î‡∏∂‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ó‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡πÇ‡∏°‡πÄ‡∏î‡∏• generate ‡∏¢‡∏≤‡∏ß)
    match = re.search(r"\b([0-3])\b", predicted_class_text)

    return int(match.group(1)) if match else 3  # default: ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢


def generate_prompt(question, question_type, purpose="expand", top_docs=None):
    max_token_count = 500  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î token ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö prompt

    # ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á ‡πÉ‡∏´‡πâ‡∏£‡∏ß‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ç‡∏≠‡∏á prompt
    context_content = ""
    if top_docs:
        context_parts = []
        for doc, score in top_docs:
            content = doc.get("chunk_content", "")
            context_parts.append(f"‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á: {content}")
        context_content = "\n\n".join(context_parts)

    if purpose == "expand":
        # Prompt ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°
        if question_type == 0:
            prompt = f"""
                    ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 256 Token ‡πÇ‡∏î‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÑ‡∏î‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢:
                    - ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á (‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡∏•‡∏±‡∏Å‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå, ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏£‡πâ‡∏≤‡∏¢‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢, ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏ï‡πà‡∏≤‡∏á‡πÜ)
                    - ‡∏£‡∏∞‡∏ö‡∏∏‡∏ñ‡∏∂‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏ó‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Ç‡∏≠‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏°‡∏≤‡∏ï‡∏£‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÜ
                    - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ö‡∏ó‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏ö‡∏ó‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÉ‡∏ä‡πâ‡∏ï‡∏≤‡∏°‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥
                    - ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î (‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à) ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡∏î‡πâ‡∏ß‡∏¢ ‡πÅ‡∏•‡∏∞‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏Ç‡πâ‡∏≠‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ

                    ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: '{question}'
                    """
            if context_content:
                prompt += f"\n\n‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á:\n{context_content}"

        elif question_type == 1:
            prompt = f"""
                    ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 256 Token ‡πÇ‡∏î‡∏¢‡πÄ‡∏ô‡πâ‡∏ô‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:
                    - ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏Å‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏ö‡∏™‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©
                    - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡πÉ‡∏ô‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡∏ó‡∏≤‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏®‡∏≤‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á
                    - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ñ‡∏∂‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á ‡πÇ‡∏î‡∏¢‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏ß‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡πÉ‡∏ô‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ï‡πà‡∏≤‡∏á ‡πÜ
                    - ‡∏£‡∏∞‡∏ö‡∏∏‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏ñ‡∏Å‡πÄ‡∏ñ‡∏µ‡∏¢‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏ô‡∏µ‡πâ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á

                    ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: '{question}'
                    """
            if context_content:
                prompt += f"\n\n‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á:\n{context_content}"

        elif question_type == 2:
            prompt = f"""
                   ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 256 Token ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ô‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡∏ó‡∏µ‡πà‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô ‡πÇ‡∏î‡∏¢‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢:
                    - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÑ‡∏õ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ó‡∏≤‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢
                    - ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á ‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏Ñ‡∏ß‡∏≤‡∏° ‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡πà‡∏ô‡∏ü‡πâ‡∏≠‡∏á ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ï‡∏ô‡πÄ‡∏≠‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå
                    - ‡∏£‡∏∞‡∏ö‡∏∏‡∏ñ‡∏∂‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏°‡∏≤‡∏ï‡∏£‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏´‡πâ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ñ‡∏∂‡∏á‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ß‡πà‡∏≤‡∏Ñ‡∏ß‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ
                    - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πà‡∏≤‡∏¢‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

                    ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: '{question}'
                    """
            if context_content:
                prompt += f"\n\n‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á:\n{context_content}"

    elif purpose == "answer":
        # Prompt ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°
        if question_type == 0:
            prompt = f"""
                    ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏ô‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÑ‡∏ó‡∏¢

                    ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡πÇ‡∏î‡∏¢‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡πÑ‡∏ß‡πâ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô:
                    - ‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô
                    - ‡∏´‡πâ‡∏≤‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
                    - ‡∏£‡∏∞‡∏ö‡∏∏‡∏ö‡∏ó‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è
                    - ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡πÉ‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤ "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡πÉ‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á"

                    ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: '{question[:max_token_count]}'
                    """
            if context_content:
                prompt += f"\n\n‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á:\n{context_content}"

        elif question_type == 1:
            prompt = f"""
                    ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏ô‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏≤‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡πÇ‡∏î‡∏¢‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
                    ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏°‡∏≤‡∏ï‡∏£‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î ‡πÇ‡∏î‡∏¢‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏ó‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡πÄ‡∏ô‡πâ‡∏ô‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ô‡∏≥‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì:
                    - ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
                    - ‡πÉ‡∏ä‡πâ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥
                    ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: '{question[:max_token_count]}'
                    """
            if context_content:
                prompt += f"\n\n‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á:\n{context_content}"

        elif question_type == 2:
            prompt = f"""
                    ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏ô‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢
                    ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏°‡∏≤‡∏ï‡∏£‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î ‡πÇ‡∏î‡∏¢‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏ó‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡πÄ‡∏ô‡πâ‡∏ô‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ô‡∏≥‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì:
                    - ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ ‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡πà‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
                    - ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
                    ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: '{question[:max_token_count]}'
                    """
            if context_content:
                prompt += f"\n\n‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á:\n{context_content}"

    return prompt


def calculate_similarity(question_embedding, docs):
    results = []
    for doc in docs:
        doc_embedding = doc.get("embedding")
        if doc_embedding:
            similarity = cosine_similarity(question_embedding, doc_embedding)
            if similarity >= 0.95:  # ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏°‡∏µ similarity ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ threshold
                results.append((doc, similarity))
    return sorted(results, key=lambda x: x[1], reverse=True)


def question_type_matches_doc_type(doc, question_type):
    """
    Return True if the document type aligns with the question type,
    ensuring only relevant documents are included in the context.
    """
    doc_type = doc.get("‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢")
    if question_type == 0 and doc_type == "‡∏°‡∏≤‡∏ï‡∏£‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î":
        return True
    elif question_type == 1 and doc_type == "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°":
        return True
    elif question_type == 2 and doc_type == "‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥":
        return True
    return False


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°
def should_expand_question(question):
    if not question.strip():
        # st.write("‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç: ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°")  # Debug
        return False  # ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö False

    keywords = [
        "‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£",
        "‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£",
        "‡∏ó‡∏≥‡πÑ‡∏°",
        "‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏≠‡∏∞‡πÑ‡∏£",
        "‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà",
        "‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£",
        "‡πÅ‡∏ö‡∏ö‡πÑ‡∏´‡∏ô",
        "‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏∞‡πÑ‡∏£",
        "‡∏ó‡∏≥‡∏¢‡∏±‡∏á‡πÑ‡∏á",
        "‡∏ú‡∏¥‡∏î‡∏≠‡∏∞‡πÑ‡∏£‡∏°‡∏±‡πâ‡∏¢",
        "‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡∏°‡∏±‡πâ‡∏¢",
        "‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà",
    ]
    words = word_tokenize(question, keep_whitespace=False)  # ‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á
    # st.write(f"‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î‡∏°‡∏≤‡πÑ‡∏î‡πâ: {words}")  # Debug

    if any(keyword in question for keyword in keywords):
        # st.write("‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç: ‡∏û‡∏ö‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏¢‡∏≤‡∏¢")  # Debug
        return False  # ‡∏ñ‡πâ‡∏≤‡∏û‡∏ö‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏î ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°

    # st.write("‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç: ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡∏Ñ‡∏ß‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢")  # Debug
    return True


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°
def ask_question_to_claude(question):
    try:
        start_time = time.time()
        st.write("üîç ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°...")

        corrected_question = question
        question_type = classify_question_type(corrected_question)
        st.write(f"‚úÖ ‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÑ‡∏î‡πâ: {question_type}")

        if question_type == 3:
            st.write("‚ùå ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢")
            return "‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢", [], None

        should_expand = should_expand_question(corrected_question)
        st.write(f"üìö ‡∏Ñ‡∏ß‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: {should_expand}")

        llm = get_llm()

        if should_expand:
            st.write("‚úçÔ∏è ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á prompt ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°...")
            prompt_for_expansion = generate_prompt(
                corrected_question, question_type, purpose="expand"
            )
            expanded = llm(prompt_for_expansion, max_new_tokens=256)[0][
                "generated_text"
            ].strip()
            st.write("‚úÖ ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à")
        else:
            expanded = corrected_question
            st.write("üìå ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏î‡∏¥‡∏°‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏Ç‡∏¢‡∏≤‡∏¢")

        st.write("üìê ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ù‡∏±‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢ embedder...")
        embedder = get_embedder()
        question_embedding = embedder.encode(expanded).tolist()
        st.write("‚úÖ ‡∏ù‡∏±‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à")

        st.write("üìÅ ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á...")
        top_docs = get_top_documents_with_similarity(
            question_embedding, threshold=0.95, top_k=10
        )
        st.write(f"‚úÖ ‡∏û‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: {len(top_docs)}")

        st.write("ü§ñ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÑ‡∏õ‡∏¢‡∏±‡∏á LLM ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö...")
        answer_prompt = generate_prompt(
            expanded, question_type, purpose="answer", top_docs=top_docs
        )
        response = llm(answer_prompt, max_new_tokens=512)[0]["generated_text"].strip()
        st.write("‚úÖ ‡πÑ‡∏î‡πâ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å LLM ‡πÅ‡∏•‡πâ‡∏ß")

        if not response:
            st.write("‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å LLM")
            return "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö", top_docs, answer_prompt

        if response.startswith("‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°"):
            response = response.split("\n", 1)[-1].strip()

        end_time = time.time()
        st.write(f"‚è±Ô∏è ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: {end_time - start_time:.2f} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ")

        return response, top_docs, answer_prompt

    except Exception as e:
        st.error(f"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: {str(e)}")
        return "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•", [], None


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô‡∏î‡∏∂‡∏á doc ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á ‡πÄ‡∏ä‡πà‡∏ô ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà chunk_index ‡πÄ‡∏õ‡πá‡∏ô 4 (‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 6 chunk) ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ß‡πâ‡∏à‡∏∞‡∏î‡∏∂‡∏á‡πÄ‡∏≠‡∏≤ chunk ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏±‡πâ‡∏ô (‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 6 chunk) ‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö chunk_index ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö


def get_top_documents_with_similarity(question_embedding, threshold=0.85, top_k=10):
    docs = list(
        document_collection.find(
            {"status": "Activate"},
            {"chunk_content": 1, "embedding": 1, "document_id": 1},
        )
    )
    docs_with_scores = []

    for doc in docs:
        doc_embedding = doc.get("embedding")
        if doc_embedding:
            similarity = cosine_similarity(question_embedding, doc_embedding)
            docs_with_scores.append((doc, similarity))

    sorted_docs = sorted(docs_with_scores, key=lambda x: x[1], reverse=True)
    top_similarity = sorted_docs[0][1] if sorted_docs else 0
    similarity_threshold = threshold * top_similarity

    filtered_docs = [
        (doc, score) for doc, score in sorted_docs if score >= similarity_threshold
    ]

    # üëâ ‡∏î‡∏∂‡∏á chunk ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
    unique_docs = {}
    for doc, score in filtered_docs:
        document_id = doc["document_id"]
        if document_id not in unique_docs:
            chunks = list(
                document_collection.find({"document_id": document_id}).sort(
                    "chunk_index", 1
                )
            )
            unique_docs[document_id] = chunks

    # üëâ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö‡∏£‡∏ß‡∏°‡∏ó‡∏∏‡∏Å chunk ‡∏û‡∏£‡πâ‡∏≠‡∏° score
    combined_docs = [
        (chunk, cosine_similarity(question_embedding, chunk["embedding"]))
        for doc_id, chunks in unique_docs.items()
        for chunk in chunks
    ]

    return combined_docs[:top_k]


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô‡∏î‡∏∂‡∏á doc ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á ‡πÄ‡∏ä‡πà‡∏ô ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà chunk_index ‡πÄ‡∏õ‡πá‡∏ô 4 (‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 6 chunk) ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ß‡πâ‡∏à‡∏∞‡∏î‡∏∂‡∏á‡πÄ‡∏≠‡∏≤ chunk ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏±‡πâ‡∏ô (‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 6 chunk) ‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö chunk_index ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á prompt ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ç‡∏¢‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏°‡πÄ‡∏î‡∏• LLM ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡πÅ‡∏•‡∏∞‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏°‡∏≤
def create_prompt_with_expanded_question_and_context(
    expanded_question, top_docs, question_type
):
    """
    Create a prompt that combines the expanded question from Claude and the context from MongoDB,
    filtered and structured according to the question type.
    """
    context_parts = []

    # Filter and structure context based on question_type relevance
    for doc, score in top_docs:
        if question_type_matches_doc_type(
            doc, question_type
        ):  # Implement a function to match types
            law_type = doc.get("‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢", "N/A")
            section = doc.get("‡∏†‡∏≤‡∏Ñ", "N/A")
            sub_section = doc.get("‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞", "N/A")
            category = doc.get("‡∏´‡∏°‡∏ß‡∏î", "N/A")
            section_number = doc.get("‡∏°‡∏≤‡∏ï‡∏£‡∏≤", "N/A")
            content = doc.get("chunk_content", "")

            # Create a structured context part for each document
            context_part = f"‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: {law_type}, ‡∏†‡∏≤‡∏Ñ: {section}, ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞: {sub_section}, ‡∏´‡∏°‡∏ß‡∏î: {category}, ‡∏°‡∏≤‡∏ï‡∏£‡∏≤: {section_number}\n‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤: {content}"
            context_parts.append(context_part)

    # Combine all context parts into one string
    combined_context = "\n\n".join(context_parts)

    # Create the final prompt with the expanded question and the combined context
    # Final prompt combining expanded question with filtered context
    prompt = f"""
       ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ: {expanded_question}

       ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°:
       {combined_context}

       ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡πÇ‡∏î‡∏¢‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÉ‡∏ô "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°" ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏î‡∏±‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ:
       1. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏≠‡∏ö‡∏Ñ‡∏≠‡∏ö ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°
       2. ‡∏´‡πâ‡∏≤‡∏°‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÉ‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡πÉ‡∏´‡πâ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
       3. ‡∏´‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤ "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á" ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏Ñ‡∏≤‡∏î‡πÄ‡∏î‡∏≤‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÉ‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
       4. ‡πÉ‡∏ä‡πâ‡∏†‡∏≤‡∏©‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£ ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö

       ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:
       - ‡∏´‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏°‡∏≤‡∏ï‡∏£‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πÅ‡∏•‡∏∞‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
       - ‡∏´‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥ ‡πÉ‡∏´‡πâ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£

       ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö:
       - ‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠: "‡∏°‡∏≤‡∏ï‡∏£‡∏≤ 5 ‡∏Ç‡∏≠‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡πà‡∏≤‡∏î‡πâ‡∏ß‡∏¢... ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤..."
       - ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á"
       """
    return prompt

    # Print or return the generated prompt with the expanded question and context
    # st.write("Generated Prompt with Expanded Question and Context:")
    # st.write(prompt)

    # return prompt


# Save chat to MongoDB
def save_chat_to_db(username, question, response, context):
    chat_history = {
        "username": username,
        "question": question,
        "response": response,
        "context": context,
        "timestamp": datetime.utcnow(),
    }
    try:
        conversation_collection.insert_one(chat_history)
    except Exception as e:
        st.error(f"Error saving chat: {str(e)}")


# ‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ñ‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î------------------------------------------------------------------------------------------------------------------------------------------‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ñ‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÜ
def split_text(text, max_size=2048):
    """‡πÅ‡∏ö‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏™‡πà‡∏ß‡∏ô ‡πÇ‡∏î‡∏¢‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô max_size"""
    chunks = []
    while len(text) > max_size:
        # ‡∏´‡∏≤‡∏à‡∏∏‡∏î‡∏ï‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡∏Å‡∏±‡∏ö‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï max_size ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡πÇ‡∏î‡∏¢‡∏ï‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á
        split_index = text[:max_size].rfind(" ")
        if split_index == -1:  # ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏î‡∏ï‡∏£‡∏á max_size
            split_index = max_size
        chunks.append(text[:split_index].strip())
        text = text[split_index:].strip()
    chunks.append(text)  # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠
    return chunks


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏¢‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÑ‡∏õ‡∏¢‡∏±‡∏á LLM ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠ similarity ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå
def ask_question_to_llm(question):
    """
    Function to ask question to LLM directly without context from MongoDB documents.
    """
    try:
        start_time = time.time()
        st.write("üîç ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£")

        llm = get_llm()
        if not llm:
            st.error("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î LLM ‡πÑ‡∏î‡πâ")
            return "Error initializing the LLM."

        # ‡πÅ‡∏™‡∏î‡∏á prompt ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á LLM
        st.write("üì§ Prompt ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á LLM:")
        st.write(question)

        st.write("ü§ñ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÑ‡∏õ‡∏¢‡∏±‡∏á LLM...")
        response = llm(question, max_new_tokens=512)[0]["generated_text"].strip()
        st.write("‚úÖ ‡πÑ‡∏î‡πâ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å LLM ‡πÅ‡∏•‡πâ‡∏ß")

        end_time = time.time()
        st.write(f"‚è±Ô∏è ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•: {end_time - start_time:.2f} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ")

        if not response:
            st.warning("‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å LLM")
            return "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å LLM"

        return response

    except Exception as e:
        st.error(f"‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏à‡∏≤‡∏Å LLM: {str(e)}")
        return "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ"


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô update_document_status ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÇ‡∏î‡∏¢‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÅ‡∏•‡∏∞‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡∏∞ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏Å‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô "Deactivate" ‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
def update_document_status(
    law_type, section, sub_section, category, section_number, draft_date
):
    """
    Update document statuses: Deactivate older documents and Activate the newest one.
    """
    # Step 1: Find documents with the same law_type, section, sub_section, category, and section_number
    matching_docs = list(
        document_collection.find(
            {
                "‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢": law_type,
                "‡∏†‡∏≤‡∏Ñ": section,
                "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞": sub_section,
                "‡∏´‡∏°‡∏ß‡∏î": category,
                "‡∏°‡∏≤‡∏ï‡∏£‡∏≤": section_number,
            }
        )
    )

    # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    print(f"Found {len(matching_docs)} matching documents.")

    # Step 2: Check if there are any matching documents and deactivate the older ones
    for doc in matching_docs:
        print(f"Checking document: {doc['_id']}, Draft Date: {doc.get('‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏≤‡∏á')}")

        # Convert the draft date from the document to a datetime object for comparison
        existing_draft_date = datetime.fromisoformat(doc.get("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏≤‡∏á"))

        # If existing_draft_date is datetime, convert it to date for comparison
        if isinstance(existing_draft_date, datetime):
            existing_draft_date_only = existing_draft_date.date()
        else:
            existing_draft_date_only = existing_draft_date

        # If draft_date is datetime, convert it to date for comparison
        if isinstance(draft_date, datetime):
            new_draft_date_only = draft_date.date()
        else:
            new_draft_date_only = draft_date

        print(
            f"Existing Draft Date: {existing_draft_date_only}, New Draft Date: {new_draft_date_only}"
        )

        # If the existing document's draft date is older than the new draft date, deactivate it
        if existing_draft_date_only < new_draft_date_only:
            print(f"Deactivating document {doc['_id']}")
            document_collection.update_one(
                {"_id": doc["_id"]}, {"$set": {"status": "Deactivate"}}
            )
        else:
            print(f"Document {doc['_id']} is newer or same, not deactivating.")

    # Step 3: Return true if we deactivate the older documents
    return True


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô toggle_document_status ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏™‡∏•‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á "Activate" ‡πÅ‡∏•‡∏∞ "Deactivate" ‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• MongoDB
def toggle_document_status(document_id):
    """
    Toggle document status between Activate and Deactivate based on current status.
    """
    # Get the current status of the document
    doc = document_collection.find_one({"_id": ObjectId(document_id)})

    if doc:
        new_status = "Activate" if doc["status"] == "Deactivate" else "Deactivate"

        # Update the status in MongoDB
        document_collection.update_one(
            {"_id": ObjectId(document_id)}, {"$set": {"status": new_status}}
        )
        st.success(f"Document {document_id} status changed to {new_status}.")
    else:
        st.error("Document not found.")


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô store_law_data_in_mongo ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà ‡∏•‡∏á‡πÉ‡∏ô MongoDB ‡πÇ‡∏î‡∏¢‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "Activate" ‡πÅ‡∏•‡∏∞ ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô (‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢, ‡∏†‡∏≤‡∏Ñ, ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞, ‡∏´‡∏°‡∏ß‡∏î, ‡πÅ‡∏•‡∏∞ ‡∏°‡∏≤‡∏ï‡∏£‡∏≤)
def store_law_data_in_mongo(
    law_type,
    draft_date,
    section_number,
    law_content,
    section,
    sub_section=None,
    category=None,
):
    """
    Store new law data in MongoDB and ensure that the new document becomes Active while deactivating older ones.
    """
    # Generate a unique document ID for the new document
    document_id = str(uuid4())

    # Clean and tokenize the content
    cleaned_content = clean_and_tokenize(law_content)

    # Split the content into chunks
    chunks = split_text(cleaned_content, max_size=2048)

    # Embed the document chunks
    embedder = get_embedder()
    embeddings = embedder.encode(chunks).tolist()

    # Step 1: Deactivate older documents with the same law_type, section, sub_section, category, and section_number
    update_document_status(
        law_type, section, sub_section, category, section_number, draft_date
    )

    # Step 2: Store the new document as Active
    for i, (chunk, embedding) in enumerate(zip(chunks, embeddings)):
        chunk_data = {
            "document_id": document_id,
            "chunk_index": i,
            "‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢": law_type,
            "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏≤‡∏á": draft_date.isoformat(),
            "‡∏†‡∏≤‡∏Ñ": section,
            "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞": sub_section,
            "‡∏´‡∏°‡∏ß‡∏î": category,
            "‡∏°‡∏≤‡∏ï‡∏£‡∏≤": section_number,
            "chunk_content": chunk,
            "embedding": embedding,
            "status": "Activate",  # Mark this new document as Active
            "timestamp": datetime.utcnow(),
        }
        try:
            # Insert the new document into MongoDB
            document_collection.insert_one(chunk_data)
        except Exception as e:
            st.error(f"Error storing document in MongoDB: {str(e)}")


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≤‡∏Å MongoDB
def get_document_by_id(document_id):
    try:
        # ‡∏î‡∏∂‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏à‡∏≤‡∏Å MongoDB ‡∏ï‡∏≤‡∏° ID
        document = document_collection.find_one({"_id": ObjectId(document_id)})
        return document
    except Exception as e:
        st.error(f"Error fetching document: {str(e)}")
        return None


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏à‡∏≤‡∏Å MongoDB ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô dropdown menu
def get_document_list():
    try:
        # ‡∏î‡∏∂‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å MongoDB (‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏±‡∏ö‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡πÑ‡∏î‡πâ)
        documents = document_collection.find(
            {}, {"_id": 1, "‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢": 1, "‡∏†‡∏≤‡∏Ñ": 1, "‡∏°‡∏≤‡∏ï‡∏£‡∏≤": 1}
        )

        # Return ‡πÄ‡∏õ‡πá‡∏ô tuple (document_id, ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô dropdown)
        return [
            (
                str(doc["_id"]),
                f"‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: {doc.get('‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢', 'N/A')}, ‡∏†‡∏≤‡∏Ñ: {doc.get('‡∏†‡∏≤‡∏Ñ', 'N/A')}, ‡∏°‡∏≤‡∏ï‡∏£‡∏≤: {doc.get('‡∏°‡∏≤‡∏ï‡∏£‡∏≤', 'N/A')}",
            )
            for doc in documents
        ]
    except Exception as e:
        st.error(f"Error fetching documents: {str(e)}")
        return []


# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡πÅ‡∏≠‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ query parameters ‡πÉ‡∏´‡∏°‡πà
def rerun_app():
    st.rerun()


# ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô main
def main():
    st.title("Make The Law")

    add_css()
    tab1, tab2, tab3 = st.tabs(["Ask a Question", "Upload Law Data", "Change Status"])

    if "messages" not in st.session_state:
        st.session_state["messages"] = []

    # New Chat reset
    if st.sidebar.button("New Chat"):
        st.session_state["selected_chat"] = None
        st.session_state["messages"] = []

    show_chat_history_in_sidebar("User")

    # ‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÅ‡∏ó‡πá‡∏ö
    user_input_question = st.chat_input("Enter your question:")

    with tab1:
        for message in st.session_state["messages"]:
            role = message["role"]
            content = message["content"]
            with st.chat_message(role):
                st.markdown(content)

        if user_input_question:
            # ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô session state
            st.session_state.messages.append(
                {"role": "user", "content": user_input_question}
            )
            with st.chat_message("user"):
                st.markdown(user_input_question)

            # AI typing animation
            with st.chat_message("assistant"):
                message_placeholder = st.empty()
                # ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô animation ‡πÉ‡∏ô background thread
                with st.spinner("AI is Thinking..."):
                    ai_response, top_docs, prompt_n = ask_question_to_claude(
                        user_input_question
                    )
                # ‡∏ñ‡∏≤‡∏° AI ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏Å‡∏±‡∏ô

                # ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å AI
                if isinstance(ai_response, dict):
                    message_placeholder.markdown("‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì")
                    message_placeholder.table(pd.DataFrame.from_dict(ai_response))
                else:
                    display_ai_message_gradually(ai_response, message_placeholder)

            # ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á AI
            st.session_state.messages.append(
                {"role": "assistant", "content": ai_response}
            )

            # ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡πÉ‡∏ô MongoDB
            save_chat_to_db("User", user_input_question, ai_response, prompt_n)

    with tab2:
        st.subheader("Upload Law Data")
        st.subheader("Manage Document Status")
        law_types = [
            "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏Å‡∏è‡∏´‡∏°‡∏≤‡∏¢",
            "‡∏≠‡∏≤‡∏ç‡∏≤",
            "‡πÅ‡∏û‡πà‡∏á",
            "‡∏û‡∏£‡∏ö ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå",
            "PDPA",
            "‡πÄ‡∏Ñ‡∏™‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á",
            "‡∏û‡∏£‡∏ö ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏à‡∏±‡∏î‡∏à‡πâ‡∏≤‡∏á",
            "‡∏û‡∏£‡∏ö ‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°",
        ]
        selected_law_type = st.selectbox("‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏Å‡∏è‡∏´‡∏°‡∏≤‡∏¢", law_types, key="law_type")

        if selected_law_type == "‡∏≠‡∏≤‡∏ç‡∏≤":
            draft_date = st.date_input("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏≤‡∏á", datetime.now(), key="draft_date")
            sections = {
                "‡∏†‡∏≤‡∏Ñ ‡πë ‡∏ö‡∏ó‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë - ‡πë‡πê‡πñ)": {
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë ‡∏ö‡∏ó‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏Å‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë - ‡πë‡πê‡πë)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏ó‡∏ô‡∏¥‡∏¢‡∏≤‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë)": (1, 1),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏≠‡∏≤‡∏ç‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí - ‡πë‡πó)": (2, 17),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡πÇ‡∏ó‡∏©‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πò - ‡πï‡πò)": (18, 58),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏≠‡∏≤‡∏ç‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πï‡πô - ‡πó‡πô)": (59, 79),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πï ‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πê - ‡πò‡πí)": (80, 82),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πñ ‡∏ï‡∏±‡∏ß‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πì - ‡πò‡πô)": (83, 89),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πó ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏´‡∏•‡∏≤‡∏¢‡∏ö‡∏ó‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏•‡∏≤‡∏¢‡∏Å‡∏£‡∏∞‡∏ó‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πô‡πê - ‡πô‡πë)": (
                            90,
                            91,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πò ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏≠‡∏µ‡∏Å (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πô‡πí - ‡πô‡πî)": (92, 94),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πô ‡∏≠‡∏≤‡∏¢‡∏∏‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πô‡πï - ‡πë‡πê‡πë)": (95, 101),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πí ‡∏ö‡∏ó‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏Å‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏•‡∏´‡∏∏‡πÇ‡∏ó‡∏© (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πê‡πí - ‡πë‡πê‡πñ)": (102, 106),
                },
                "‡∏†‡∏≤‡∏Ñ ‡πí ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πê‡πó - ‡πì‡πñ‡πñ/‡πî)": {
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡πÅ‡∏´‡πà‡∏á‡∏£‡∏≤‡∏ä‡∏≠‡∏≤‡∏ì‡∏≤‡∏à‡∏±‡∏Å‡∏£ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πê‡πó - ‡πë‡πì‡πï)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏≠‡∏á‡∏Ñ‡πå‡∏û‡∏£‡∏∞‡∏°‡∏´‡∏≤‡∏Å‡∏©‡∏±‡∏ï‡∏£‡∏¥‡∏¢‡πå ‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏¥‡∏ô‡∏µ ‡∏£‡∏±‡∏ä‡∏ó‡∏≤‡∏¢‡∏≤‡∏ó ‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£‡πÅ‡∏ó‡∏ô‡∏û‡∏£‡∏∞‡∏≠‡∏á‡∏Ñ‡πå (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πê‡πó - ‡πë‡πë‡πí)": (
                            107,
                            112,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏±‡∏ê‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏£‡∏≤‡∏ä‡∏≠‡∏≤‡∏ì‡∏≤‡∏à‡∏±‡∏Å‡∏£ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πë‡πì - ‡πë‡πë‡πò)": (
                            113,
                            118,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏±‡∏ê‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡∏£‡∏≤‡∏ä‡∏≠‡∏≤‡∏ì‡∏≤‡∏à‡∏±‡∏Å‡∏£ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πë‡πô - ‡πë‡πí‡πô)": (
                            119,
                            129,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πÑ‡∏°‡∏ï‡∏£‡∏µ‡∏Å‡∏±‡∏ö‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏® (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πì‡πê - ‡πë‡πì‡πï)": (
                            130,
                            135,
                        ),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë/‡πë ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏¢ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πì‡πï/‡πë - ‡πë‡πì‡πï/‡πî)": (
                        135.1,
                        135.4,
                    ),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πí ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πì‡πñ - ‡πë‡πñ‡πñ)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πì‡πñ - ‡πë‡πî‡πñ)": (136, 146),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πî‡πó - ‡πë‡πñ‡πñ)": (147, 166),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πì ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏¢‡∏∏‡∏ï‡∏¥‡∏ò‡∏£‡∏£‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πñ‡πó - ‡πí‡πê‡πï)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏∏‡∏ï‡∏¥‡∏ò‡∏£‡∏£‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πñ‡πó - ‡πë‡πô‡πô)": (
                            167,
                            199,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏∏‡∏ï‡∏¥‡∏ò‡∏£‡∏£‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πê‡πê - ‡πí‡πê‡πï)": (
                            200,
                            205,
                        ),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πî ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏®‡∏≤‡∏™‡∏ô‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πê‡πñ - ‡πí‡πê‡πò)": (206, 208),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πï ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏á‡∏ö‡∏™‡∏∏‡∏Ç‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πê‡πô - ‡πí‡πë‡πñ)": (
                        209,
                        216,
                    ),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πñ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏†‡∏¢‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πë‡πó - ‡πí‡πì‡πô)": (
                        217,
                        239,
                    ),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πó ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏≠‡∏°‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πî‡πê - ‡πí‡πñ‡πô/‡πë‡πï)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏£‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πî‡πê - ‡πí‡πî‡πô)": (240, 249),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏î‡∏ß‡∏á‡∏ï‡∏£‡∏≤ ‡πÅ‡∏™‡∏ï‡∏°‡∏õ‡πå‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πã‡∏ß (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πï‡πê - ‡πí‡πñ‡πì)": (
                            250,
                            263,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πñ‡πî - ‡πí‡πñ‡πô)": (264, 269),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ö‡∏±‡∏ï‡∏£‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πñ‡πô/‡πë - ‡πí‡πñ‡πô/‡πó)": (
                            269.1,
                            269.7,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πï ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πñ‡πô/‡πò - ‡πí‡πñ‡πô/‡πë‡πï)": (
                            269.10,
                            269.9,
                        ),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πò ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πó‡πê - ‡πí‡πó‡πï)": (270, 275),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πô ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏® (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πó‡πñ - ‡πí‡πò‡πó/‡πí)": (276, 287.2),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë‡πê ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡πÅ‡∏•‡∏∞‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πò‡πò - ‡πì‡πê‡πò)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πò‡πò - ‡πí‡πô‡πî)": (288, 294),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πô‡πï - ‡πì‡πê‡πê)": (295, 300),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ê‡∏≤‡∏ô‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÅ‡∏ó‡πâ‡∏á‡∏•‡∏π‡∏Å (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πê‡πë - ‡πì‡πê‡πï)": (301, 305),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ê‡∏≤‡∏ô‡∏ó‡∏≠‡∏î‡∏ó‡∏¥‡πâ‡∏á‡πÄ‡∏î‡πá‡∏Å ‡∏Ñ‡∏ô‡∏õ‡πà‡∏ß‡∏¢‡πÄ‡∏à‡πá‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ô‡∏ä‡∏£‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πê‡πñ - ‡πì‡πê‡πò)": (
                            306,
                            308,
                        ),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë‡πë ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏™‡∏£‡∏µ‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏™‡∏µ‡∏¢‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πê‡πô - ‡πì‡πì‡πì)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏™‡∏£‡∏µ‡∏†‡∏≤‡∏û (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πê‡πô - ‡πì‡πí‡πë/‡πë)": (309, 321.1),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ê‡∏≤‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πí‡πí - ‡πì‡πí‡πï)": (322, 325),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ê‡∏≤‡∏ô‡∏´‡∏°‡∏¥‡πà‡∏ô‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ó (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πí‡πñ - ‡πì‡πì‡πì)": (326, 333),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë‡πí ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πì‡πî - ‡πì‡πñ‡πñ)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ê‡∏≤‡∏ô‡∏•‡∏±‡∏Å‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πà‡∏á‡∏£‡∏≤‡∏ß‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πì‡πî - ‡πì‡πì‡πñ ‡∏ó‡∏ß‡∏¥)": (
                            334,
                            336.2,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ê‡∏≤‡∏ô‡∏Å‡∏£‡∏£‡πÇ‡∏ä‡∏Å ‡∏£‡∏µ‡∏î‡πÄ‡∏≠‡∏≤‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå ‡∏ä‡∏¥‡∏á‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÅ‡∏•‡∏∞‡∏õ‡∏•‡πâ‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πì‡πó - ‡πì‡πî‡πê ‡∏ï‡∏£‡∏µ)": (
                            337,
                            340.3,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ê‡∏≤‡∏ô‡∏â‡πâ‡∏≠‡πÇ‡∏Å‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πî‡πë - ‡πì‡πî‡πò)": (341, 348),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ê‡∏≤‡∏ô‡πÇ‡∏Å‡∏á‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πî‡πô - ‡πì‡πï‡πë)": (349, 351),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πï ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ê‡∏≤‡∏ô‡∏¢‡∏±‡∏Å‡∏¢‡∏≠‡∏Å (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πï‡πí - ‡πì‡πï‡πñ)": (352, 356),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πñ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ê‡∏≤‡∏ô‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÇ‡∏à‡∏£ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πï‡πó)": (357, 357),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πó ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ê‡∏≤‡∏ô‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πï‡πò - ‡πì‡πñ‡πë)": (358, 361),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πò ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ê‡∏≤‡∏ô‡∏ö‡∏∏‡∏Å‡∏£‡∏∏‡∏Å (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πñ‡πí - ‡πì‡πñ‡πñ)": (362, 366),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë‡πì ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏®‡∏û (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πñ‡πñ/‡πë - ‡πì‡πñ‡πñ/‡πî)": (366.1, 366.4),
                },
                "‡∏†‡∏≤‡∏Ñ ‡πì ‡∏•‡∏´‡∏∏‡πÇ‡∏ó‡∏© (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πñ‡πó - ‡πì‡πô‡πò)": (367, 398),
                "‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏≠‡∏≤‡∏ç‡∏≤ ‡∏û.‡∏®. ‡πí‡πî‡πô‡πô": None,
                "‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÉ‡∏ä‡πâ": None,
                "‡∏≠‡∏∑‡πà‡∏ô‡πÜ": None,
            }

            selected_section = st.selectbox(
                "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏≤‡∏Ñ", list(sections.keys()), key="section_unique"
            )

            if selected_section in [
                "‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏≠‡∏≤‡∏ç‡∏≤ ‡∏û.‡∏®. ‡πí‡πî‡πô‡πô",
                "‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÉ‡∏ä‡πâ",
                "‡∏≠‡∏∑‡πà‡∏ô‡πÜ",
            ]:
                section_number = None  # ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏°‡∏≤‡∏ï‡∏£‡∏≤‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏ô‡∏µ‡πâ
                selected_sub_section = None
                selected_category = None
            else:
                selected_sub_section = st.selectbox(
                    "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞",
                    list(sections[selected_section]),
                    key="sub_section_unique",
                )

                if isinstance(sections[selected_section][selected_sub_section], dict):
                    selected_category = st.selectbox(
                        "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î",
                        list(sections[selected_section][selected_sub_section].keys()),
                        key="category_unique",
                    )
                    min_section, max_section = sections[selected_section][
                        selected_sub_section
                    ][selected_category]
                else:
                    selected_category = None
                    min_section, max_section = sections[selected_section][
                        selected_sub_section
                    ]

                # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏°
                if selected_category in [
                    "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ö‡∏±‡∏ï‡∏£‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πñ‡πô/‡πë - ‡πí‡πñ‡πô/‡πó)",
                    "‡∏´‡∏°‡∏ß‡∏î ‡πï ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πñ‡πô/‡πò - ‡πí‡πñ‡πô/‡πë‡πï)",
                ] or selected_sub_section in [
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë/‡πë ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏¢ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πì‡πï/‡πë - ‡πë‡πì‡πï/‡πî)",
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πô ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏® (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πó‡πñ - ‡πí‡πò‡πó/‡πí)",
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë‡πì ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏®‡∏û (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πñ‡πñ/‡πë - ‡πì‡πñ‡πñ/‡πî)",
                ]:
                    section_number = st.number_input(
                        f"‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ({min_section} - {max_section})",
                        min_value=float(min_section),
                        max_value=float(max_section),
                        step=0.01,  # ‡πÉ‡∏ä‡πâ‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏° 2 ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
                        format="%.2f",
                        key="section_number_unique",
                    )
                else:
                    section_number = st.number_input(
                        f"‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ({min_section} - {max_section})",
                        min_value=int(min_section),
                        max_value=int(max_section),
                        format="%d",  # ‡πÉ‡∏ä‡πâ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ï‡πá‡∏°
                        key="section_number_unique",
                    )

            law_content = st.text_area(
                "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢", height=400, key="law_content_unique"
            )

            if st.button("Submit", key="submit_law_btn_unique"):
                if not section_number and selected_section not in [
                    "‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏≠‡∏≤‡∏ç‡∏≤ ‡∏û.‡∏®. ‡πí‡πî‡πô‡πô",
                    "‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÉ‡∏ä‡πâ",
                    "‡∏≠‡∏∑‡πà‡∏ô‡πÜ",
                ]:
                    st.error("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á ‡∏°‡∏≤‡∏ï‡∏£‡∏≤")
                elif not law_content:
                    st.error("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢")
                else:
                    st.success(
                        f"‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:\n‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: {selected_law_type}\n‡∏†‡∏≤‡∏Ñ: {selected_section}\n‡∏°‡∏≤‡∏ï‡∏£‡∏≤: {section_number or 'N/A'}\n‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢: {law_content}"
                    )
                    with st.spinner("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ù‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•..."):
                        try:
                            store_law_data_in_mongo(
                                selected_law_type,
                                draft_date,
                                section_number,
                                law_content,
                                selected_section,
                                selected_sub_section,
                                selected_category,
                            )
                            st.success("‡∏ù‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á MongoDB ‡πÅ‡∏•‡πâ‡∏ß!")
                        except Exception as e:
                            st.error(f"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: {str(e)}")

        elif selected_law_type == "‡πÅ‡∏û‡πà‡∏á":
            draft_date = st.date_input("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏≤‡∏á", datetime.now(), key="draft_date")
            sections = {
                "‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏û‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå": {
                    "‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏Å‡∏§‡∏©‡∏é‡∏µ‡∏Å‡∏≤‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏û‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå ‡∏ö‡∏£‡∏£‡∏û ‡πë ‡πÅ‡∏•‡∏∞ ‡πí ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏ä‡∏≥‡∏£‡∏∞‡πÉ‡∏´‡∏°‡πà": None,
                    "‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏ö‡∏ó‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡∏ö‡∏£‡∏£‡∏û ‡πë ‡πÅ‡∏´‡πà‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏û‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏ä‡∏≥‡∏£‡∏∞‡πÉ‡∏´‡∏°‡πà ‡∏û.‡∏®. ‡πí‡πï‡πì‡πï": None,
                    "‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏Å‡∏§‡∏©‡∏é‡∏µ‡∏Å‡∏≤‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏ö‡∏ó‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡πÅ‡∏´‡πà‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏û‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå ‡∏ö‡∏£‡∏£‡∏û ‡πì ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏ä‡∏≥‡∏£‡∏∞‡πÉ‡∏´‡∏°‡πà": None,
                    "‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏Å‡∏§‡∏©‡∏é‡∏µ‡∏Å‡∏≤‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏ö‡∏ó‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥ ‡∏ö‡∏£‡∏£‡∏û ‡πî ‡πÅ‡∏´‡πà‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏û‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå": None,
                    "‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏ö‡∏ó‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡∏ö‡∏£‡∏£‡∏û ‡πï ‡πÅ‡∏´‡πà‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏û‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏ä‡∏≥‡∏£‡∏∞‡πÉ‡∏´‡∏°‡πà ‡∏û.‡∏®. ‡πí‡πï‡πë‡πô": None,
                    "‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏ö‡∏ó‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡∏ö‡∏£‡∏£‡∏û ‡πñ ‡πÅ‡∏´‡πà‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏û‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå ‡∏û‡∏∏‡∏ó‡∏ò‡∏®‡∏±‡∏Å‡∏£‡∏≤‡∏ä ‡πí‡πî‡πó‡πó": None,
                },
                "‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë - ‡πì)": (1, 3),
                "‡∏ö‡∏£‡∏£‡∏û ‡πë ‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πî - ‡πë‡πô‡πì/‡πì‡πï)": {
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πî - ‡πë‡πî)": (4, 14),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πí ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πï - ‡πë‡πì‡πñ)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πï - ‡πñ‡πî)": (15, 64),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏ô‡∏¥‡∏ï‡∏¥‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πñ‡πï - ‡πë‡πì‡πñ)": (65, 136),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πì ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πì‡πó - ‡πë‡πî‡πò)": (137, 148),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πî ‡∏ô‡∏¥‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πî‡πô - ‡πë‡πô‡πì)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πî‡πô - ‡πë‡πï‡πì)": (149, 153),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏à‡∏ï‡∏ô‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πï‡πî - ‡πë‡πó‡πë)": (154, 171),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡πÇ‡∏°‡∏Ü‡∏∞‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏•‡∏∞‡πÇ‡∏°‡∏Ü‡∏µ‡∏¢‡∏∞‡∏Å‡∏£‡∏£‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πó‡πí - ‡πë‡πò‡πë)": (172, 181),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πò‡πí - ‡πë‡πô‡πì)": (182, 193),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πï ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πô‡πì/‡πë - ‡πë‡πô‡πì/‡πò)": (193.1, 193.8),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πñ ‡∏≠‡∏≤‡∏¢‡∏∏‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πô‡πì/‡πô - ‡πë‡πô‡πì/‡πì‡πï)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πô‡πì/‡πô - ‡πë‡πô‡πì/‡πí‡πô)": (193.10, 193.9),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πô‡πì/‡πì‡πê - ‡πë‡πô‡πì/‡πì‡πï)": (193.30, 193.35),
                    },
                },
                "‡∏ö‡∏£‡∏£‡∏û ‡πí ‡∏´‡∏ô‡∏µ‡πâ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πô‡πî - ‡πî‡πï‡πí)": {
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πô‡πî - ‡πì‡πï‡πì)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡πÅ‡∏´‡πà‡∏á‡∏´‡∏ô‡∏µ‡πâ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πô‡πî - ‡πí‡πê‡πí)": (194, 202),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏ú‡∏•‡πÅ‡∏´‡πà‡∏á‡∏´‡∏ô‡∏µ‡πâ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πê‡πì - ‡πí‡πò‡πô)": (203, 289),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πí‡πô‡πê - ‡πì‡πê‡πí)": (290, 302),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡πÇ‡∏≠‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏£‡πâ‡∏≠‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πê‡πì - ‡πì‡πë‡πì)": (303, 313),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πï ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∞‡∏á‡∏±‡∏ö‡πÅ‡∏´‡πà‡∏á‡∏´‡∏ô‡∏µ‡πâ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πë‡πî - ‡πì‡πï‡πì)": (314, 353),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πí ‡∏™‡∏±‡∏ç‡∏ç‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πï‡πî - ‡πì‡πô‡πî)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏Å‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πï‡πî - ‡πì‡πñ‡πò)": (354, 368),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏ú‡∏•‡πÅ‡∏´‡πà‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πñ‡πô - ‡πì‡πó‡πñ)": (369, 376),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏°‡∏±‡∏î‡∏à‡∏≥‡πÅ‡∏•‡∏∞‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏£‡∏±‡∏ö (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πó‡πó - ‡πì‡πò‡πï)": (377, 385),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏±‡∏ç‡∏ç‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πò‡πñ - ‡πì‡πô‡πî)": (386, 394),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πì ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ô‡∏≠‡∏Å‡∏™‡∏±‡πà‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πì‡πô‡πï - ‡πî‡πê‡πï)": (395, 405),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πî ‡∏•‡∏≤‡∏†‡∏°‡∏¥‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πî‡πê‡πñ - ‡πî‡πë‡πô)": (406, 419),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πï ‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πî‡πí‡πê - ‡πî‡πï‡πí)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πî‡πí‡πê - ‡πî‡πì‡πó)": (420, 437),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏Ñ‡πà‡∏≤‡∏™‡∏¥‡∏ô‡πÑ‡∏´‡∏°‡∏ó‡∏î‡πÅ‡∏ó‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πî‡πì‡πò - ‡πî‡πî‡πò)": (438, 448),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏ô‡∏¥‡∏£‡πÇ‡∏ó‡∏©‡∏Å‡∏£‡∏£‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πî‡πî‡πô - ‡πî‡πï‡πí)": (449, 452),
                    },
                },
                "‡∏ö‡∏£‡∏£‡∏û ‡πì ‡πÄ‡∏≠‡∏Å‡πÄ‡∏ó‡∏®‡∏™‡∏±‡∏ç‡∏ç‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πî‡πï‡πì - ‡πë‡πí‡πô‡πó)": {
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë ‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πî‡πï‡πì - ‡πï‡πë‡πó)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πî‡πï‡πì - ‡πî‡πñ‡πê)": (
                            453,
                            460,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πî‡πñ‡πë - ‡πî‡πò‡πï)": (461, 485),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ã‡∏∑‡πâ‡∏≠ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πî‡πò‡πñ - ‡πî‡πô‡πê)": (486, 490),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πî‡πô‡πë - ‡πï‡πë‡πó)": (491, 517),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πí ‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πï‡πë‡πò - ‡πï‡πí‡πê)": (518, 520),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πì ‡πÉ‡∏´‡πâ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πï‡πí‡πë - ‡πï‡πì‡πñ)": (521, 536),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πî ‡πÄ‡∏ä‡πà‡∏≤‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πï‡πì‡πó - ‡πï‡πó‡πë)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πï‡πì‡πó - ‡πï‡πî‡πï)": (537, 545),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏ä‡πà‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πï‡πî‡πñ - ‡πï‡πï‡πë)": (546, 551),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πï‡πï‡πí - ‡πï‡πñ‡πì)": (552, 563),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∞‡∏á‡∏±‡∏ö‡πÅ‡∏´‡πà‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡πÄ‡∏ä‡πà‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πï‡πñ‡πî - ‡πï‡πó‡πë)": (564, 571),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πï ‡πÄ‡∏ä‡πà‡∏≤‡∏ã‡∏∑‡πâ‡∏≠ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πï‡πó‡πí - ‡πï‡πó‡πî)": (572, 574),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πñ ‡∏à‡πâ‡∏≤‡∏á‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πï‡πó‡πï - ‡πï‡πò‡πñ)": (575, 586),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πó ‡∏à‡πâ‡∏≤‡∏á‡∏ó‡∏≥‡∏Ç‡∏≠‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πï‡πò‡πó - ‡πñ‡πê‡πó)": (587, 607),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πò ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πñ‡πê‡πò - ‡πñ‡πì‡πô)": (608, 639),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πô ‡∏¢‡∏∑‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πñ‡πî‡πê - ‡πñ‡πï‡πñ)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏¢‡∏∑‡∏°‡πÉ‡∏ä‡πâ‡∏Ñ‡∏á‡∏£‡∏π‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πñ‡πî‡πê - ‡πñ‡πî‡πô)": (640, 649),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏¢‡∏∑‡∏°‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡πâ‡∏ô‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πñ‡πï‡πê - ‡πñ‡πï‡πñ)": (650, 656),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë‡πê ‡∏ù‡∏≤‡∏Å‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πñ‡πï‡πó - ‡πñ‡πó‡πô)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πñ‡πï‡πó - ‡πñ‡πó‡πë)": (657, 671),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏≤‡∏£‡∏ù‡∏≤‡∏Å‡πÄ‡∏á‡∏¥‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πñ‡πó‡πí - ‡πñ‡πó‡πì)": (672, 673),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πñ‡πó‡πî - ‡πñ‡πó‡πô)": (
                            674,
                            679,
                        ),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë‡πë ‡∏Ñ‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πñ‡πò‡πê - ‡πó‡πê‡πë)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πñ‡πò‡πê - ‡πñ‡πò‡πï/‡πë)": (680.0, 685.1),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏ú‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏ä‡∏≥‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πñ‡πò‡πñ - ‡πñ‡πô‡πí)": (686, 692),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏ú‡∏•‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πñ‡πô‡πì - ‡πñ‡πô‡πó)": (693, 697),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏™‡∏¥‡πâ‡∏ô‡πÑ‡∏õ‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πñ‡πô‡πò - ‡πó‡πê‡πë)": (
                            698,
                            701,
                        ),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë‡πí ‡∏à‡∏≥‡∏ô‡∏≠‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πê‡πí - ‡πó‡πî‡πñ)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πê‡πí - ‡πó‡πë‡πî/‡πë)": (702.0, 714.1),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏à‡∏≥‡∏ô‡∏≠‡∏á‡∏Ñ‡∏£‡∏≠‡∏ö‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÉ‡∏î (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πë‡πï - ‡πó‡πí‡πë)": (715, 721),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏à‡∏≥‡∏ô‡∏≠‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πí‡πí - ‡πó‡πí‡πó/‡πë)": (
                            722.0,
                            727.1,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏≠‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πí‡πò - ‡πó‡πì‡πï)": (728, 735),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πï ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏≠‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏ã‡∏∂‡πà‡∏á‡∏à‡∏≥‡∏ô‡∏≠‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πì‡πñ - ‡πó‡πî‡πì)": (
                            736,
                            743,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πñ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏™‡∏¥‡πâ‡∏ô‡πÑ‡∏õ‡πÅ‡∏´‡πà‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏à‡∏≥‡∏ô‡∏≠‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πî‡πî - ‡πó‡πî‡πñ)": (744, 746),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë‡πì ‡∏à‡∏≥‡∏ô‡∏≥ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πî‡πó - ‡πó‡πñ‡πô)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πî‡πó - ‡πó‡πï‡πó)": (747, 757),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏à‡∏≥‡∏ô‡∏≥‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏≥ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πï‡πò - ‡πó‡πñ‡πì)": (
                            758,
                            763,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏≥ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πñ‡πî - ‡πó‡πñ‡πò)": (764, 768),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏™‡∏¥‡πâ‡∏ô‡πÑ‡∏õ‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏ô‡∏≥ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πñ‡πô)": (769, 769),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë‡πî ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏≠‡∏á‡πÉ‡∏ô‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πó‡πê - ‡πó‡πô‡πñ)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πó‡πê - ‡πó‡πó‡πî)": (770, 774),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏ó‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πó‡πï - ‡πó‡πô‡πñ)": (
                            775,
                            796,
                        ),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë‡πï ‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πô‡πó - ‡πò‡πî‡πî)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πó‡πô‡πó - ‡πò‡πê‡πñ)": (797, 806),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏ï‡πà‡∏≠‡∏ï‡∏±‡∏ß‡∏Å‡∏≤‡∏£ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πê‡πó - ‡πò‡πë‡πî)": (
                            807,
                            814,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πë‡πï - ‡πò‡πë‡πô)": (
                            815,
                            819,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏ï‡πà‡∏≠‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πí‡πê - ‡πò‡πí‡πï)": (
                            820,
                            825,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πï ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏™‡∏¥‡πâ‡∏ô‡πÑ‡∏õ‡πÅ‡∏´‡πà‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πí‡πñ - ‡πò‡πì‡πí)": (826, 832),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πñ ‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πì‡πì - ‡πò‡πî‡πî)": (833, 844),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë‡πñ ‡∏ô‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πî‡πï - ‡πò‡πî‡πô)": (845, 849),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë‡πó ‡∏õ‡∏£‡∏∞‡∏ô‡∏µ‡∏õ‡∏£‡∏∞‡∏ô‡∏≠‡∏°‡∏¢‡∏≠‡∏°‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πï‡πê - ‡πò‡πï‡πí)": (850, 852),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë‡πò ‡∏Å‡∏≤‡∏£‡∏û‡∏ô‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏Ç‡∏±‡∏ô‡∏ï‡πà‡∏≠ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πï‡πì - ‡πò‡πï‡πï)": (853, 855),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë‡πô ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÄ‡∏î‡∏¥‡∏ô‡∏™‡∏∞‡∏û‡∏±‡∏î (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πï‡πñ - ‡πò‡πñ‡πê)": (856, 860),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πí‡πê ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏†‡∏±‡∏¢ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πñ‡πë - ‡πò‡πô‡πó)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πñ‡πë - ‡πò‡πñ‡πò)": (861, 868),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏ß‡∏¥‡∏ô‡∏≤‡∏®‡∏†‡∏±‡∏¢ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πñ‡πô - ‡πò‡πò‡πò)": (869, 888),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πò‡πô - ‡πò‡πô‡πó)": (889, 897),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πí‡πë ‡∏ï‡∏±‡πã‡∏ß‡πÄ‡∏á‡∏¥‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πô‡πò - ‡πë‡πê‡πë‡πë)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πò‡πô‡πò - ‡πô‡πê‡πó)": (898, 907),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏ï‡∏±‡πã‡∏ß‡πÅ‡∏•‡∏Å‡πÄ‡∏á‡∏¥‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πô‡πê‡πò - ‡πô‡πò‡πë)": (908, 981),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏ï‡∏±‡πã‡∏ß‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡πÉ‡∏ä‡πâ‡πÄ‡∏á‡∏¥‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πô‡πò‡πí - ‡πô‡πò‡πñ)": (982, 986),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡πÄ‡∏ä‡πá‡∏Ñ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πô‡πò‡πó - ‡πë‡πê‡πê‡πê)": (987, 1000),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πï ‡∏≠‡∏≤‡∏¢‡∏∏‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πê‡πê‡πë - ‡πë‡πê‡πê‡πï)": (1001, 1005),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πñ ‡∏ï‡∏±‡πã‡∏ß‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≠‡∏° ‡∏ï‡∏±‡πã‡∏ß‡πÄ‡∏á‡∏¥‡∏ô‡∏ñ‡∏π‡∏Å‡∏•‡∏±‡∏Å ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πã‡∏ß‡πÄ‡∏á‡∏¥‡∏ô‡∏´‡∏≤‡∏¢ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πê‡πê‡πñ - ‡πë‡πê‡πë‡πë)": (
                            1006,
                            1011,
                        ),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πí‡πí ‡∏´‡∏∏‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πê‡πê‡πí - ‡πë‡πí‡πó‡πì/‡πî)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πê‡πë‡πí - ‡πë‡πê‡πí‡πî)": (1012, 1024),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏´‡πâ‡∏≤‡∏á‡∏´‡∏∏‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏≤‡∏°‡∏±‡∏ç (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πê‡πí‡πï - ‡πë‡πê‡πó‡πñ)": (1025, 1076),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏´‡πâ‡∏≤‡∏á‡∏´‡∏∏‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏≥‡∏Å‡∏±‡∏î (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πê‡πó‡πó - ‡πë‡πê‡πô‡πï)": (1077, 1095),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏à‡∏≥‡∏Å‡∏±‡∏î (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πê‡πô‡πñ - ‡πë‡πí‡πî‡πñ/‡πó)": (1096.0, 1246.7),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πï ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏´‡πâ‡∏≤‡∏á‡∏´‡∏∏‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏î‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô ‡∏´‡πâ‡∏≤‡∏á‡∏´‡∏∏‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏≥‡∏Å‡∏±‡∏î ‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏à‡∏≥‡∏Å‡∏±‡∏î (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πí‡πî‡πó - ‡πë‡πí‡πó‡πì)": (
                            1247,
                            1273,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πñ ‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏´‡πâ‡∏≤‡∏á‡∏´‡∏∏‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏î‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô ‡∏´‡πâ‡∏≤‡∏á‡∏´‡∏∏‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏≥‡∏Å‡∏±‡∏î ‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏£‡πâ‡∏≤‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πí‡πó‡πì/‡πë - ‡πë‡πí‡πó‡πì/‡πî)": (
                            1273.1,
                            1273.4,
                        ),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πí‡πì ‡∏™‡∏°‡∏≤‡∏Ñ‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πí‡πó‡πî - ‡πë‡πí‡πô‡πó)": (1274, 1297),
                },
                "‡∏ö‡∏£‡∏£‡∏û ‡πî ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πí‡πô‡πò - ‡πë‡πî‡πì‡πî)": {
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πí‡πô‡πò - ‡πë‡πì‡πê‡πó)": (1298, 1307),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πí ‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πì‡πê‡πò - ‡πë‡πì‡πñ‡πñ)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏ã‡∏∂‡πà‡∏á‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πì‡πê‡πò - ‡πë‡πì‡πì‡πî)": (1308, 1334),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡πÅ‡∏î‡∏ô‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πì‡πì‡πï - ‡πë‡πì‡πï‡πï)": (
                            1335,
                            1355,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏£‡∏ß‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πì‡πï‡πñ - ‡πë‡πì‡πñ‡πñ)": (1356, 1366),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πì ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏≠‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πì‡πñ‡πó - ‡πë‡πì‡πò‡πñ)": (1367, 1386),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πî ‡∏†‡∏≤‡∏£‡∏∞‡∏à‡∏≥‡∏¢‡∏≠‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πì‡πò‡πó - ‡πë‡πî‡πê‡πë)": (1387, 1401),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πï ‡∏≠‡∏≤‡∏®‡∏±‡∏¢ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πî‡πê‡πí - ‡πë‡πî‡πê‡πô)": (1402, 1409),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πñ ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πî‡πë‡πê - ‡πë‡πî‡πë‡πñ)": (1410, 1416),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πó ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏Å‡πá‡∏ö‡∏Å‡∏¥‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πî‡πë‡πó - ‡πë‡πî‡πí‡πò)": (1417, 1428),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πò ‡∏†‡∏≤‡∏£‡∏∞‡∏ï‡∏¥‡∏î‡∏û‡∏±‡∏ô‡πÉ‡∏ô‡∏≠‡∏™‡∏±‡∏á‡∏´‡∏≤‡∏£‡∏¥‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πî‡πí‡πô - ‡πë‡πî‡πì‡πî)": (1429, 1434),
                },
                "‡∏ö‡∏£‡∏£‡∏û ‡πï ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πî‡πì‡πï - ‡πë‡πï‡πô‡πò/‡πî‡πë)": {
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë ‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏£‡∏™ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πî‡πì‡πï - ‡πë‡πï‡πì‡πï)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏±‡πâ‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πî‡πì‡πï - ‡πë‡πî‡πî‡πó/‡πí)": (1435.0, 1447.2),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏£‡∏™ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πî‡πî‡πò - ‡πë‡πî‡πñ‡πê)": (1448, 1460),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏≤‡∏°‡∏µ‡∏†‡∏£‡∏¥‡∏¢‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πî‡πñ‡πë - ‡πë‡πî‡πñ‡πî/‡πë)": (
                            1461.0,
                            1464.1,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏≤‡∏°‡∏µ‡∏†‡∏£‡∏¥‡∏¢‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πî‡πñ‡πï - ‡πë‡πî‡πô‡πì)": (1465, 1493),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πï ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏°‡∏Ü‡∏∞‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏£‡∏™ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πî‡πô‡πî - ‡πë‡πï‡πê‡πê)": (
                            1494,
                            1500,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πñ ‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏£‡∏™ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πï‡πê‡πë - ‡πë‡πï‡πì‡πï)": (1501, 1535),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πí ‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤‡∏Å‡∏±‡∏ö‡∏ö‡∏∏‡∏ï‡∏£ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πï‡πì‡πñ - ‡πë‡πï‡πô‡πò/‡πì‡πó)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πï‡πì‡πñ - ‡πë‡πï‡πñ‡πê)": (1536, 1560),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤‡πÅ‡∏•‡∏∞‡∏ö‡∏∏‡∏ï‡∏£ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πï‡πñ‡πë - ‡πë‡πï‡πò‡πî/‡πë)": (
                            1561.0,
                            1584.1,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πï‡πò‡πï - ‡πë‡πï‡πô‡πò/‡πë‡πò)": (1585.00, 1598.9),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏ö‡∏∏‡∏ï‡∏£‡∏ö‡∏∏‡∏ç‡∏ò‡∏£‡∏£‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πï‡πô‡πò/‡πë‡πô - ‡πë‡πï‡πô‡πò/‡πì‡πó)": (
                            1598.19,
                            1598.37,
                        ),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πì ‡∏Ñ‡πà‡∏≤‡∏≠‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏∞‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏î‡∏π (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πï‡πô‡πò/‡πì‡πò - ‡πë‡πï‡πô‡πò/‡πî‡πë)": (
                        1598.38,
                        1598.41,
                    ),
                },
                "‡∏ö‡∏£‡∏£‡∏û ‡πñ ‡∏°‡∏£‡∏î‡∏Å (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πï‡πô‡πô - ‡πë‡πó‡πï‡πï)": {
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πï‡πô‡πô - ‡πë‡πñ‡πë‡πô)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡∏ó‡∏≠‡∏î‡πÅ‡∏´‡πà‡∏á‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏°‡∏£‡∏î‡∏Å (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πï‡πô‡πô - ‡πë‡πñ‡πê‡πì)": (1599, 1603),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏¢‡∏≤‡∏ó (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πñ‡πê‡πî - ‡πë‡πñ‡πê‡πó)": (1604, 1607),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏°‡∏¥‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏£‡∏î‡∏Å (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πñ‡πê‡πò - ‡πë‡πñ‡πê‡πô)": (1608, 1609),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏Å‡∏≤‡∏£‡∏™‡∏•‡∏∞‡∏°‡∏£‡∏î‡∏Å‡πÅ‡∏•‡∏∞‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πñ‡πë‡πê - ‡πë‡πñ‡πë‡πô)": (1610, 1619),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πí ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÇ‡∏î‡∏¢‡∏ò‡∏£‡∏£‡∏°‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏°‡∏£‡∏î‡∏Å (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πñ‡πí‡πê - ‡πë‡πñ‡πî‡πï)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πñ‡πí‡πê - ‡πë‡πñ‡πí‡πò)": (1620, 1628),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏°‡∏£‡∏î‡∏Å‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏≤‡∏¢‡∏≤‡∏ó‡πÇ‡∏î‡∏¢‡∏ò‡∏£‡∏£‡∏°‡πÉ‡∏ô‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≤‡∏á ‡πÜ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πñ‡πí‡πô - ‡πë‡πñ‡πì‡πë)": (
                            1629,
                            1631,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏°‡∏£‡∏î‡∏Å‡∏Ç‡∏≠‡∏á‡∏ó‡∏≤‡∏¢‡∏≤‡∏ó‡πÇ‡∏î‡∏¢‡∏ò‡∏£‡∏£‡∏°‡πÉ‡∏ô‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≤‡∏á ‡πÜ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πñ‡πì‡πí - ‡πë‡πñ‡πì‡πò)": (
                            1632,
                            1638,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏°‡∏£‡∏î‡∏Å‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏±‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πñ‡πì‡πô - ‡πë‡πñ‡πî‡πï)": (1639, 1645),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πì ‡∏û‡∏¥‡∏ô‡∏±‡∏¢‡∏Å‡∏£‡∏£‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πñ‡πî‡πñ - ‡πë‡πó‡πë‡πê)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ö‡∏ó‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πñ‡πî‡πñ - ‡πë‡πñ‡πï‡πî)": (1646, 1654),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡πÅ‡∏ö‡∏ö‡∏û‡∏¥‡∏ô‡∏±‡∏¢‡∏Å‡∏£‡∏£‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πñ‡πï‡πï - ‡πë‡πñ‡πó‡πí)": (1655, 1672),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏ú‡∏•‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏´‡πà‡∏á‡∏û‡∏¥‡∏ô‡∏±‡∏¢‡∏Å‡∏£‡∏£‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πñ‡πó‡πì - ‡πë‡πñ‡πò‡πï)": (
                            1673,
                            1685,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πî ‡∏û‡∏¥‡∏ô‡∏±‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πñ‡πò‡πñ - ‡πë‡πñ‡πô‡πí)": (
                            1686,
                            1692,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πï ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡∏Å‡∏ñ‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡πÑ‡∏õ‡πÅ‡∏´‡πà‡∏á‡∏û‡∏¥‡∏ô‡∏±‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏û‡∏¥‡∏ô‡∏±‡∏¢‡∏Å‡∏£‡∏£‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πñ‡πô‡πì - ‡πë‡πñ‡πô‡πô)": (
                            1693,
                            1699,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πñ ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡πÄ‡∏õ‡∏•‡πà‡∏≤‡πÅ‡∏´‡πà‡∏á‡∏û‡∏¥‡∏ô‡∏±‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏û‡∏¥‡∏ô‡∏±‡∏¢‡∏Å‡∏£‡∏£‡∏° (‡πë‡πó‡πê‡πê - ‡πë‡πó‡πë‡πê)": (
                            1700,
                            1710,
                        ),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πî ‡∏ß‡∏¥‡∏ò‡∏µ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏õ‡∏±‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏°‡∏£‡∏î‡∏Å (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πó‡πë‡πë - ‡πë‡πó‡πï‡πí)": {
                        "‡∏´‡∏°‡∏ß‡∏î ‡πë ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏°‡∏£‡∏î‡∏Å (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πó‡πë‡πë - ‡πë‡πó‡πì‡πì)": (1711, 1733),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πí ‡∏Å‡∏≤‡∏£‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏°‡∏£‡∏î‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡∏Å‡∏±‡∏ö‡πÅ‡∏ö‡πà‡∏á‡∏õ‡∏±‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏°‡∏£‡∏î‡∏Å (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πó‡πì‡πî - ‡πë‡πó‡πî‡πî)": (
                            1734,
                            1744,
                        ),
                        "‡∏´‡∏°‡∏ß‡∏î ‡πì ‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏°‡∏£‡∏î‡∏Å (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πó‡πî‡πï - ‡πë‡πó‡πï‡πí)": (1745, 1752),
                    },
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πï ‡∏°‡∏£‡∏î‡∏Å‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πó‡πï‡πì)": (1753),
                    "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ ‡πñ ‡∏≠‡∏≤‡∏¢‡∏∏‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë‡πó‡πï‡πî - ‡πë‡πó‡πï‡πï)": (1754, 1755),
                },
                "‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÉ‡∏ä‡πâ": None,
                "‡∏≠‡∏∑‡πà‡∏ô‡πÜ": None,
            }

            selected_section = st.selectbox(
                "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏£‡∏£‡∏û", list(sections.keys()), key="section_unique"
            )

            # ‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏Å‡∏§‡∏©‡∏é‡∏µ‡∏Å‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÉ‡∏ä‡πâ
            if selected_section in [
                "‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏û‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå",
                "‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÉ‡∏ä‡πâ",
                "‡∏≠‡∏∑‡πà‡∏ô‡πÜ",
            ]:
                selected_sub_section = None
                selected_category = None
                section_number = None
                if selected_section == "‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏û‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå":
                    selected_sub_section = st.selectbox(
                        "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£",
                        list(sections[selected_section].keys()),
                        key="sub_section_unique",
                    )
            else:
                # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏£‡∏ì‡∏µ "‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë - ‡πì)"
                if selected_section == "‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô (‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ‡πë - ‡πì)":
                    min_section, max_section = sections[selected_section]
                    section_number = st.number_input(
                        f"‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ({min_section} - {max_section})",
                        min_value=int(min_section),
                        max_value=int(max_section),
                        format="%d",
                        key="section_number_unique",
                    )
                    selected_sub_section = None
                    selected_category = None
                else:
                    selected_sub_section = st.selectbox(
                        "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞",
                        list(sections[selected_section]),
                        key="sub_section_unique",
                    )
                    if isinstance(
                        sections[selected_section][selected_sub_section], dict
                    ):
                        selected_category = st.selectbox(
                            "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î",
                            list(
                                sections[selected_section][selected_sub_section].keys()
                            ),
                            key="category_unique",
                        )
                        min_section, max_section = sections[selected_section][
                            selected_sub_section
                        ][selected_category]
                    else:
                        selected_category = None
                        value = sections[selected_section][selected_sub_section]
                        min_section, max_section = (
                            value if isinstance(value, tuple) else (value, value)
                        )

                    section_number = st.number_input(
                        f"‡∏°‡∏≤‡∏ï‡∏£‡∏≤ ({min_section} - {max_section})",
                        min_value=(
                            float(min_section)
                            if isinstance(min_section, float)
                            else int(min_section)
                        ),
                        max_value=(
                            float(max_section)
                            if isinstance(max_section, float)
                            else int(max_section)
                        ),
                        step=0.01 if isinstance(min_section, float) else 1,
                        format="%.2f" if isinstance(min_section, float) else "%d",
                        key="section_number_unique",
                    )

            law_content = st.text_area(
                "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢", height=400, key="law_content_unique"
            )

            if st.button("Submit", key="submit_law_btn_unique"):
                if not section_number and selected_section not in [
                    "‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏û‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå",
                    "‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÉ‡∏ä‡πâ",
                ]:
                    st.error("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á ‡∏°‡∏≤‡∏ï‡∏£‡∏≤")
                elif not law_content:
                    st.error("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢")
                else:
                    st.success(
                        f"‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:\n‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: {selected_law_type}\n‡∏ö‡∏£‡∏£‡∏û: {selected_section}\n‡∏°‡∏≤‡∏ï‡∏£‡∏≤: {section_number or 'N/A'}\n‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢: {law_content}"
                    )
                    with st.spinner("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ù‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•..."):
                        try:
                            store_law_data_in_mongo(
                                selected_law_type,
                                draft_date,
                                section_number,
                                law_content,
                                selected_section,
                                selected_sub_section,
                                selected_category,
                            )
                            st.success("‡∏ù‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á MongoDB ‡πÅ‡∏•‡πâ‡∏ß!")
                        except Exception as e:
                            st.error(f"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: {str(e)}")

        # ‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏û‡∏£‡∏ö ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå"
        if selected_law_type == "‡∏û‡∏£‡∏ö ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå":
            # ‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏≤‡∏á
            draft_date = st.date_input("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏≤‡∏á", datetime.now(), key="draft_date")

            # ‡∏î‡∏£‡∏≠‡∏õ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"
            additional_option = st.selectbox(
                "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠", ["‡∏°‡∏≤‡∏ï‡∏£‡∏≤‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô", "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"], key="additional_option"
            )

            # ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏≠‡∏∑‡πà‡∏ô‡πÜ" ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏Å‡∏°‡∏≤‡∏ï‡∏£‡∏≤
            if additional_option != "‡∏≠‡∏∑‡πà‡∏ô‡πÜ":
                law_section = st.text_input(
                    "‡∏°‡∏≤‡∏ï‡∏£‡∏≤", key="law_section"
                )  # ‡πÅ‡∏™‡∏î‡∏á‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏°‡∏≤‡∏ï‡∏£‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"
                selected_section = additional_option  # ‡πÉ‡∏ä‡πâ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏î‡∏£‡∏≠‡∏õ‡∏î‡∏≤‡∏ß‡∏ô‡πå
            else:
                selected_section = "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏õ‡πá‡∏ô "‡∏≠‡∏∑‡πà‡∏ô‡πÜ" ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ü‡∏¥‡∏•‡∏î‡πå "‡∏°‡∏≤‡∏ï‡∏£‡∏≤"

            # ‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢
            law_content = st.text_area(
                "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢", height=400, key="law_content_unique"
            )

            if st.button("Submit", key="submit_law_btn_unique"):
                if not law_content:
                    st.error("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢")
                else:
                    # ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                    st.success(
                        f"‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:\n‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: {selected_law_type}\n‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠: {selected_section}\n"
                        f"‡∏°‡∏≤‡∏ï‡∏£‡∏≤: {law_section if additional_option != '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' and law_section else 'N/A'}\n‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢: {law_content}"
                    )
                    with st.spinner("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ù‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•..."):
                        try:
                            # ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏õ‡∏¢‡∏±‡∏á MongoDB
                            store_law_data_in_mongo(
                                selected_law_type,
                                draft_date,
                                law_section if additional_option != "‡∏≠‡∏∑‡πà‡∏ô‡πÜ" else None,
                                law_content,
                                selected_section,
                            )
                            st.success("‡∏ù‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á MongoDB ‡πÅ‡∏•‡πâ‡∏ß!")
                        except Exception as e:
                            st.error(f"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: {str(e)}")

        elif selected_law_type == "PDPA":
            # ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "PDPA" ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô "‡∏û‡∏£‡∏ö ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå"
            draft_date = st.date_input("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏≤‡∏á", datetime.now(), key="draft_date_pdpa")
            additional_option = st.selectbox(
                "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠", ["‡∏°‡∏≤‡∏ï‡∏£‡∏≤‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô", "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"], key="additional_option_pdpa"
            )

            if additional_option != "‡∏≠‡∏∑‡πà‡∏ô‡πÜ":
                law_section = st.text_input("‡∏°‡∏≤‡∏ï‡∏£‡∏≤", key="law_section_pdpa")
                selected_section = additional_option
            else:
                selected_section = "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"
                law_section = None

            law_content = st.text_area(
                "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢", height=400, key="law_content_pdpa"
            )

            if st.button("Submit", key="submit_law_btn_pdpa"):
                if not law_content:
                    st.error("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢")
                else:
                    st.success(
                        f"‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:\n‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: {selected_law_type}\n‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠: {selected_section}\n"
                        f"‡∏°‡∏≤‡∏ï‡∏£‡∏≤: {law_section if law_section else 'N/A'}\n‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢: {law_content}"
                    )
                    with st.spinner("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ù‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•..."):
                        try:
                            store_law_data_in_mongo(
                                selected_law_type,
                                draft_date,
                                law_section,
                                law_content,
                                selected_section,
                            )
                            st.success("‡∏ù‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á MongoDB ‡πÅ‡∏•‡πâ‡∏ß!")
                        except Exception as e:
                            st.error(f"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: {str(e)}")

        # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡πÄ‡∏Ñ‡∏™‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á" ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢

        if selected_law_type in [
            "‡πÄ‡∏Ñ‡∏™‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á",
            "‡∏û‡∏£‡∏ö ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏à‡∏±‡∏î‡∏à‡πâ‡∏≤‡∏á",
            "‡∏û‡∏£‡∏ö ‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°",
        ]:
            # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÉ‡∏™‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
            draft_date = st.date_input(
                "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏≤‡∏á", datetime.now(), key=f"draft_date_{selected_law_type}"
            )
            # ‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢
            law_content = st.text_area(
                "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢", height=400, key=f"law_content_{selected_law_type}"
            )

            # ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
            if st.button("Submit", key=f"submit_{selected_law_type}"):
                if not law_content:
                    st.error("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢")
                else:
                    st.success(
                        f"{selected_law_type} ‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:\n‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢: {law_content}"
                    )
                    with st.spinner("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ù‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•..."):
                        try:
                            # ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô store_law_data_in_mongo ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á embedding
                            store_law_data_in_mongo(
                                selected_law_type,
                                draft_date,
                                None,
                                law_content,
                                selected_law_type,
                            )
                            st.success("‡∏ù‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á MongoDB ‡πÅ‡∏•‡πâ‡∏ß!")
                        except Exception as e:
                            st.error(f"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: {str(e)}")

    with tab3:
        st.subheader("Change Status")

        # ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏à‡∏≤‡∏Å MongoDB ‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô dropdown
        document_list = get_document_list()

        if document_list:
            # ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏™‡πà Document ID ‡πÄ‡∏õ‡πá‡∏ô dropdown ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            selected_document = st.selectbox(
                "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞", document_list, format_func=lambda x: x[1]
            )

            # ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‡πÉ‡∏´‡πâ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á
            document_data = get_document_by_id(selected_document[0])

            if document_data:
                # ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
                st.write(f"‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: {document_data.get('‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢', 'N/A')}")
                st.write(f"‡∏†‡∏≤‡∏Ñ: {document_data.get('‡∏†‡∏≤‡∏Ñ', 'N/A')}")
                st.write(f"‡∏°‡∏≤‡∏ï‡∏£‡∏≤: {document_data.get('‡∏°‡∏≤‡∏ï‡∏£‡∏≤', 'N/A')}")
                st.write(f"‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤: {document_data.get('chunk_content', 'N/A')}")
                st.write(f"‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: {document_data.get('status', 'N/A')}")

                # ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‡∏û‡∏£‡πâ‡∏≠‡∏° key ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô
                if st.button("Toggle Status", key="toggle_status_button"):
                    toggle_document_status(selected_document[0])  # ‡∏™‡πà‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Document ID

                    # ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏•‡πâ‡∏ß
                    updated_document_data = get_document_by_id(selected_document[0])

                    if updated_document_data:
                        st.success("‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!")
                        # ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                        st.write(
                            f"‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: {updated_document_data.get('‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢', 'N/A')}"
                        )
                        st.write(f"‡∏†‡∏≤‡∏Ñ: {updated_document_data.get('‡∏†‡∏≤‡∏Ñ', 'N/A')}")
                        st.write(f"‡∏°‡∏≤‡∏ï‡∏£‡∏≤: {updated_document_data.get('‡∏°‡∏≤‡∏ï‡∏£‡∏≤', 'N/A')}")
                        st.write(
                            f"‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤: {updated_document_data.get('chunk_content', 'N/A')}"
                        )
                        st.write(
                            f"‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: {updated_document_data.get('status', 'N/A')}"
                        )
            else:
                st.write("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£")
        else:
            st.write("‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£")


if __name__ == "__main__":
    main()
